generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id       Int     @id @default(autoincrement()) @map("UserId")
  username String? @map("Username") @db.VarChar(50)
  email    String? @map("Email") @db.VarChar(255)
  password String? @map("Password") @db.VarChar(255)
  status   String? @default("A") @map("Status") @db.VarChar(5)

  roles    RolUsuario[]

  @@map("User")
}

model Rol {
  id        Int      @id @default(autoincrement()) @map("RolId")
  nombre    String   @map("RolNombre") @db.VarChar(50)
  descripcion String? @map("descripcion") @db.VarChar(255)
  usuarios  RolUsuario[]

  permisosModulos PermisosModulos[]

  @@map("Rol")
}

model RolUsuario {
  id_usuario Int  @map("UserId")
  id_rol     Int  @map("RolId")

  user User @relation(fields: [id_usuario], references: [id])
  rol  Rol  @relation(fields: [id_rol], references: [id])

  @@id([id_usuario, id_rol])
  @@map("RolUsuario")
}

model Bitacora {
  Id     Int     @id @default(autoincrement())
  UserId Int?
  Tipo   String? @db.VarChar(255)
}

model Modulos {
  id        Int     @id @default(autoincrement()) @map("id")
  nombre    String  @db.VarChar(255)
  descripcion String? @db.VarChar(255)
  permisosModulos PermisosModulos[]

  @@map("Modulos")
}

model Permisos {
  id        Int     @id @default(autoincrement()) @map("id")
  nombre    String  @db.VarChar(255)
  descripcion String? @db.VarChar(255)
  permisosModulos PermisosModulos[]

  @@map("Permisos")
}

model PermisosModulos {
  rolId     Int     @map("rolId")
  moduloId  Int     @map("moduloId")
  permisoId Int     @map("permisoId")

  rol    Rol      @relation(fields: [rolId], references: [id])
  modulo Modulos  @relation(fields: [moduloId], references: [id])
  permiso Permisos @relation(fields: [permisoId], references: [id])

  @@id([rolId, moduloId, permisoId])
  @@map("PermisosModulos")
}
